# Admin接口调试指南

## 问题排查步骤

### 1. 使用直接测试页面
打开 `test-admin-direct.html` 文件，直接在浏览器中测试接口：
- 避免uni-app环境的问题
- 可以看到详细的请求和响应信息
- 支持多种测试用例

### 2. 检查控制台日志
在uni-app中打开开发者工具，查看控制台输出：
- 请求参数是否正确
- 响应数据的具体内容
- 错误信息的详细信息

### 3. 常见问题排查

#### 问题1: 跨域问题
**症状**: 请求失败，错误信息包含"fail"
**解决**: 
- 后端需要设置CORS头
- 或者使用代理服务器

#### 问题2: 参数格式问题
**症状**: 后端收到参数但查询不到数据
**检查**:
- `admin_id` 和 `locker_point_id` 的类型
- 数据库中是否有对应的数据

#### 问题3: 响应格式问题
**症状**: 前端显示"获取数据失败"
**检查**:
- 后端返回的 `code` 字段是否为 200
- 数据字段名是否匹配

### 4. 调试信息说明

#### 前端调试信息
```
=== 请求详情 ===
请求URL: http://localhost:8000/admin
请求方法: POST
请求参数: {admin_id: "1", locker_point_id: "1"}
adminId类型: string
lockerPointId类型: string

=== 接口响应详情 ===
完整响应: {...}
响应数据: {...}
响应状态码: 200
code字段值: 200
code字段类型: number
```

#### 后端调试信息
查看后端日志，确认：
- 接口是否被调用
- 接收到的参数
- 数据库查询结果
- 返回的数据

### 5. 测试用例

#### 测试用例1: 基本参数
```json
{
  "admin_id": "1",
  "locker_point_id": "1"
}
```

#### 测试用例2: 手机号作为管理员ID
```json
{
  "admin_id": "13661740781",
  "locker_point_id": "1"
}
```

#### 测试用例3: 不同网点ID
```json
{
  "admin_id": "1",
  "locker_point_id": "2"
}
```

### 6. 预期响应格式

成功响应应该包含：
```json
{
  "code": 200,
  "msg": "查询成功",
  "pointNum": 10,
  "lastOrderNum": 5,
  "yesterdayOrderNum": 3,
  "lastOrderPrice": 150.5,
  "mouthPrice": 1200.0,
  "monthNum": 25
}
```

### 7. 数据库检查

确认数据库中有以下数据：
1. `LockerPoint` 表中有对应的 `admin_id` 记录
2. `LockerOrders` 表中有对应的 `locker_point_id` 记录
3. 订单数据的时间范围正确

### 8. 后端接口检查

确认后端接口：
1. 监听正确的端口 (8000)
2. 支持 POST 方法
3. 接受 `application/x-www-form-urlencoded` 格式
4. 返回正确的 JSON 格式

### 9. 网络检查

1. 确认后端服务正在运行
2. 确认端口 8000 没有被占用
3. 确认防火墙没有阻止请求
4. 确认网络连接正常

### 10. 快速修复建议

如果问题仍然存在，可以尝试：

1. **重启后端服务**
2. **清除浏览器缓存**
3. **检查数据库连接**
4. **查看后端错误日志**
5. **使用 Postman 测试接口**

## 联系支持

如果按照以上步骤仍然无法解决问题，请提供：
1. 前端控制台的完整日志
2. 后端接口的响应数据
3. 数据库查询结果
4. 具体的错误信息 