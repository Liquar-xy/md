import{r as t,g as a,a as e,m as o,q as s,v as i,y as n,p as l,e as c,w as d,i as p,o as f,f as u,j as h,t as r,n as m,C as I,D as _,F as b,k as g,u as v,l as k,x as T}from"./index-BgeTyoVd.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const y=C({data:()=>({pointId:null,pointName:"",pointInfo:{name:"",address:"",pointType:"",availableLarge:0,availableMedium:0,availableSmall:0,openTime:"",staus:1,pointImage:"",photos:[]},isSaving:!1}),onLoad(t){this.pointId=t.id||"new",this.pointName=decodeURIComponent(t.name||""),"new"===this.pointId?(console.log("æ–°å¢ç½‘ç‚¹æ¨¡å¼"),this.pointInfo={name:"",address:"",pointType:"",availableLarge:0,availableMedium:0,availableSmall:0,openTime:"",staus:1,pointImage:"",photos:[]}):(console.log("ä¿®æ”¹ç½‘ç‚¹æ¨¡å¼ï¼ŒID:",this.pointId),this.getPointInfo())},methods:{getPointInfo(){console.log("æ­£åœ¨è·å–ç½‘ç‚¹ä¿¡æ¯ï¼ŒID:",this.pointId),t({url:"http://localhost:8000/point_info",method:"POST",data:{id:this.pointId},header:{"Content-Type":"application/json",Authorization:"Bearer "+a("adminToken")},success:t=>{var a;console.log("ç½‘ç‚¹ä¿¡æ¯æ¥å£è¿”å›æ•°æ®:",t),!t.data||200!==t.data.code&&"200"!==t.data.code?(console.error("æ¥å£è¿”å›é”™è¯¯:",t.data),e({title:(null==(a=t.data)?void 0:a.msg)||"è·å–ç½‘ç‚¹ä¿¡æ¯å¤±è´¥",icon:"none"})):(this.pointInfo={name:t.data.name||t.data.Name||"",address:t.data.address||t.data.Address||"",pointType:t.data.pointType||t.data.PointType||"",availableLarge:parseInt(t.data.availableLarge||t.data.AvailableLarge)||0,availableMedium:parseInt(t.data.availableMedium||t.data.AvailableMedium)||0,availableSmall:parseInt(t.data.availableSmall||t.data.AvailableSmall)||0,openTime:t.data.openTime||t.data.OpenTime||"",staus:parseInt(t.data.staus||t.data.Status)||1,pointImage:t.data.pointImage||t.data.PointImage||"",photos:t.data.photos||t.data.Photos||[]},console.log("å¤„ç†åçš„ç½‘ç‚¹ä¿¡æ¯:",this.pointInfo),e({title:"æ•°æ®åŠ è½½æˆåŠŸ",icon:"success",duration:1e3}))},fail:t=>{console.error("ç½‘ç‚¹ä¿¡æ¯è¯·æ±‚å¤±è´¥:",t),e({title:"ç½‘ç»œè¯·æ±‚å¤±è´¥",icon:"none"})}})},getCabinetInfo(){const{availableLarge:t,availableMedium:a,availableSmall:e}=this.pointInfo;return`${t}ç»„${a}ä¸»æœº${e}æŸœé—¨`},editField(t){console.log("ç‚¹å‡»ç¼–è¾‘å­—æ®µ:",t);const a={name:"ç½‘ç‚¹åç§°",address:"ç½‘ç‚¹åœ°å€",pointType:"ç½‘ç‚¹ç±»å‹",cabinet:"ç®¡ç†æŸœç»„",openTime:"è¥ä¸šæ—¶é—´",status:"ç½‘ç‚¹çŠ¶æ€"}[t]||t;if("cabinet"!==t)if("status"!==t){switch(t){case"name":this.pointInfo.name;break;case"address":this.pointInfo.address;break;case"pointType":this.pointInfo.pointType;break;case"openTime":this.pointInfo.openTime}o({title:`ç¼–è¾‘${a}`,content:"",editable:!0,placeholderText:`è¯·è¾“å…¥${a}`,success:a=>{if(a.confirm){const o=a.content.trim();if(o){switch(t){case"name":this.pointInfo.name=o;break;case"address":this.pointInfo.address=o;break;case"pointType":this.pointInfo.pointType=o;break;case"openTime":this.pointInfo.openTime=o}e({title:"ä¿®æ”¹æˆåŠŸ",icon:"success"})}}}})}else this.editStatus();else this.editCabinet()},editCabinet(){console.log("ç¼–è¾‘æŸœç»„ä¿¡æ¯è¢«è°ƒç”¨"),o({title:"ç¼–è¾‘æŸœç»„ä¿¡æ¯",content:"",editable:!0,placeholderText:"è¯·è¾“å…¥ï¼šç»„æ•°,ä¸»æœºæ•°,æŸœé—¨æ•°ï¼ˆä¾‹å¦‚ï¼š10,15,20ï¼‰",success:t=>{console.log("è¾“å…¥ç»“æœ:",t),t.confirm&&t.content&&this.processCabinetInput(t.content)}})},processCabinetInput(t){console.log("ç”¨æˆ·è¾“å…¥:",t);const a=t.split(/[,ï¼Œ\s]+/).map((t=>parseInt(t.trim())||0));console.log("è§£æç»“æœ:",a),3===a.length?(this.pointInfo.availableLarge=a[0],this.pointInfo.availableMedium=a[1],this.pointInfo.availableSmall=a[2],console.log("æ›´æ–°åçš„æŸœç»„æ•°æ®:",this.pointInfo.availableLarge,this.pointInfo.availableMedium,this.pointInfo.availableSmall),e({title:`å·²è®¾ç½®ä¸ºï¼š${a[0]}ç»„${a[1]}ä¸»æœº${a[2]}æŸœé—¨`,icon:"success",duration:2e3})):e({title:"æ ¼å¼é”™è¯¯ï¼Œè¯·è¾“å…¥ä¸‰ä¸ªæ•°å­—ï¼Œç”¨é€—å·åˆ†éš”",icon:"none",duration:3e3})},editStatus(){const t=[{text:"æ­£å¸¸",value:1},{text:"æš‚åœè¥ä¸š",value:0}];s({itemList:t.map((t=>t.text)),success:a=>{const o=t[a.tapIndex];this.pointInfo.staus=o.value,e({title:`çŠ¶æ€å·²è®¾ç½®ä¸º${o.text}`,icon:"success"})}})},viewChargingRules(){i({url:`/pages/price-rule/price-rule?id=${this.pointId}&name=${encodeURIComponent(this.pointInfo.name||this.pointName)}`})},uploadPhoto(){n({count:1,success:t=>{const a=t.tempFilePaths[0];this.pointInfo.pointImage=a,this.pointInfo.photos.includes(a)||this.pointInfo.photos.unshift(a),e({title:"ç…§ç‰‡ä¸Šä¼ æˆåŠŸ",icon:"success"})}})},addPhoto(){n({count:1,success:t=>{const a=t.tempFilePaths[0];this.pointInfo.photos.push(a),e({title:"ç…§ç‰‡æ·»åŠ æˆåŠŸ",icon:"success"})}})},removePhoto(t){const a=this.pointInfo.photos[t];this.pointInfo.pointImage===a&&(this.pointInfo.pointImage=""),this.pointInfo.photos.splice(t,1),e({title:"ç…§ç‰‡åˆ é™¤æˆåŠŸ",icon:"success"})},setMainPhoto(t){this.pointInfo.pointImage=t,e({title:"å·²è®¾ç½®ä¸ºä¸»ç…§ç‰‡",icon:"success"})},savePoint(){this.pointInfo.name&&""!==this.pointInfo.name.trim()?this.pointInfo.address&&""!==this.pointInfo.address.trim()?this.pointInfo.pointType&&""!==this.pointInfo.pointType.trim()?(this.isSaving=!0,console.log("ä¿å­˜ç½‘ç‚¹ä¿¡æ¯:",{name:this.pointInfo.name,address:this.pointInfo.address,pointType:this.pointInfo.pointType,availableLarge:this.pointInfo.availableLarge,availableMedium:this.pointInfo.availableMedium,availableSmall:this.pointInfo.availableSmall,openTime:this.pointInfo.openTime,status:this.pointInfo.staus,pointImage:this.pointInfo.pointImage,photos:this.pointInfo.photos}),setTimeout((()=>{this.isSaving=!1;const t=this.pointId&&"new"!==this.pointId;e({title:t?"ä¿®æ”¹æˆåŠŸ":"æ–°å¢æˆåŠŸ",icon:"success",duration:3e3}),console.log("ä¿å­˜å®Œæˆï¼Œåœç•™åœ¨å½“å‰é¡µé¢")}),500)):e({title:"è¯·è¾“å…¥ç½‘ç‚¹ç±»å‹",icon:"none"}):e({title:"è¯·è¾“å…¥ç½‘ç‚¹åœ°å€",icon:"none"}):e({title:"è¯·è¾“å…¥ç½‘ç‚¹åç§°",icon:"none"})},goBack(){l()}}},[["render",function(t,a,e,o,s,i){const n=g,l=p,C=v,y=k;return f(),c(l,{class:"point-edit"},{default:d((()=>[u(l,{class:"header"},{default:d((()=>[u(l,{class:"back-btn",onClick:i.goBack},{default:d((()=>[u(n,{class:"back-icon"},{default:d((()=>[h("â†")])),_:1})])),_:1},8,["onClick"]),u(l,{class:"title"},{default:d((()=>[h(r("new"===s.pointId?"æ–°å¢ç½‘ç‚¹":"ç¼–è¾‘ç½‘ç‚¹"),1)])),_:1}),u(l,{class:"header-right"},{default:d((()=>[u(n,{class:"menu-icon"},{default:d((()=>[h("â‹¯")])),_:1}),u(n,{class:"target-icon"},{default:d((()=>[h("â—")])),_:1})])),_:1})])),_:1}),u(l,{class:"photo-section"},{default:d((()=>[u(l,{class:"photo-placeholder",onClick:i.uploadPhoto},{default:d((()=>[s.pointInfo.pointImage?(f(),c(C,{key:0,src:s.pointInfo.pointImage,mode:"aspectFill",class:"main-photo"},null,8,["src"])):(f(),c(l,{key:1,class:"photo-upload"},{default:d((()=>[u(n,{class:"photo-icon"},{default:d((()=>[h("ğŸ“·")])),_:1}),u(n,{class:"photo-text"},{default:d((()=>[h("ç½‘ç‚¹ç…§ç‰‡")])),_:1})])),_:1}))])),_:1},8,["onClick"])])),_:1}),u(l,{class:"info-section"},{default:d((()=>[u(l,{class:"section-header"},{default:d((()=>[u(n,{class:"section-title"},{default:d((()=>[h("ç½‘ç‚¹ä¿¡æ¯")])),_:1}),u(n,{class:"section-tip"},{default:d((()=>[h("ç‚¹å‡»å„é¡¹å¯ç¼–è¾‘")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[0]||(a[0]=t=>i.editField("name"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("ç½‘ç‚¹åç§°")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h(r(s.pointInfo.name||"æœªè®¾ç½®"),1)])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[1]||(a[1]=t=>i.editField("address"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("ç½‘ç‚¹åœ°å€")])),_:1}),u(l,{class:"address-container"},{default:d((()=>[u(n,{class:"location-icon"},{default:d((()=>[h("ğŸ“")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h(r(s.pointInfo.address||"æœªè®¾ç½®"),1)])),_:1})])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[2]||(a[2]=t=>i.editField("pointType"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("ç½‘ç‚¹ç±»å‹")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h(r(s.pointInfo.pointType||"æœªè®¾ç½®"),1)])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[3]||(a[3]=t=>i.editField("cabinet"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("ç®¡ç†æŸœç»„")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h(r(i.getCabinetInfo()),1)])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[4]||(a[4]=t=>i.editField("openTime"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("è¥ä¸šæ—¶é—´")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h(r(s.pointInfo.openTime||"æœªè®¾ç½®"),1)])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:a[5]||(a[5]=t=>i.editField("status"))},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("ç½‘ç‚¹çŠ¶æ€")])),_:1}),u(n,{class:m(["info-value",1==s.pointInfo.staus?"status-normal":"status-closed"])},{default:d((()=>[h(r(1==s.pointInfo.staus?"æ­£å¸¸":"æš‚åœè¥ä¸š"),1)])),_:1},8,["class"]),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1}),u(l,{class:"info-item",onClick:i.viewChargingRules},{default:d((()=>[u(n,{class:"info-label"},{default:d((()=>[h("æ”¶è´¹è§„åˆ™")])),_:1}),u(n,{class:"info-value"},{default:d((()=>[h("æŸ¥çœ‹")])),_:1}),u(n,{class:"arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"])])),_:1}),u(l,{class:"photo-list-section"},{default:d((()=>[u(n,{class:"section-title"},{default:d((()=>[h("ç½‘ç‚¹ç…§ç‰‡")])),_:1}),u(l,{class:"photo-list"},{default:d((()=>[(f(!0),I(b,null,_(s.pointInfo.photos,((t,a)=>(f(),c(l,{key:a,class:"photo-item"},{default:d((()=>[u(C,{src:t,mode:"aspectFill",class:"list-photo",onClick:a=>i.setMainPhoto(t)},null,8,["src","onClick"]),u(n,{class:"remove-btn",onClick:t=>i.removePhoto(a)},{default:d((()=>[h("Ã—")])),_:2},1032,["onClick"]),s.pointInfo.pointImage===t?(f(),c(n,{key:0,class:"main-photo-label"},{default:d((()=>[h("ä¸»å›¾")])),_:1})):T("",!0)])),_:2},1024)))),128)),u(l,{class:"add-photo",onClick:i.addPhoto},{default:d((()=>[u(n,{class:"add-icon"},{default:d((()=>[h("+")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),u(l,{class:"save-section"},{default:d((()=>[u(y,{class:"save-btn",onClick:i.savePoint,disabled:s.isSaving},{default:d((()=>[h(r(s.isSaving?"ä¿å­˜ä¸­...":"new"===s.pointId?"æ–°å¢":"ä¿å­˜"),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})}],["__scopeId","data-v-dee68ce4"]]);export{y as default};
