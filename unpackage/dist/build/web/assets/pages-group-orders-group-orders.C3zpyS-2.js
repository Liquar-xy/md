import{a as t,p as e,v as a,e as s,w as l,i as o,o as r,f as d,j as i,t as n,C as c,D as u,F as f,x as _,k as h,l as g,S as m,n as p}from"./index-BgeTyoVd.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const S=v({data:()=>({groupId:"",groupName:"",orderList:[],currentPage:1,pageSize:10,hasMore:!0,loading:!1,todayOrders:0,activeOrders:0,todayRevenue:0}),onLoad(e){console.log("柜组订单页面加载:",e),this.groupId=e.groupId||"",this.groupName=decodeURIComponent(e.groupName||"未知柜组"),this.groupId?this.loadOrderList():t({title:"参数错误",icon:"none"})},methods:{goBack(){e()},refreshData(){this.currentPage=1,this.hasMore=!0,this.orderList=[],this.loadOrderList()},loadOrderList(){!this.loading&&this.hasMore&&(this.loading=!0,setTimeout((()=>{this.loadMockOrderData(),this.loading=!1}),500))},loadMockOrderData(){console.log("使用模拟订单数据");const t=[],e=["active","completed","cancelled","expired"];for(let a=1;a<=this.pageSize;a++){const s=e[Math.floor(Math.random()*e.length)],l=new Date(Date.now()-864e5*Math.random()*7),o="completed"===s?new Date(l.getTime()+864e5*Math.random()):null;t.push({id:(this.currentPage-1)*this.pageSize+a,order_no:`ORD${Date.now()}${String(a).padStart(3,"0")}`,group_id:this.groupId,cell_no:String(Math.floor(20*Math.random())+1).padStart(2,"0"),status:s,start_time:l.toISOString(),end_time:(null==o?void 0:o.toISOString())||null,total_amount:(50*Math.random()+10).toFixed(2),create_time:l.toISOString(),update_time:(new Date).toISOString()})}1===this.currentPage?(this.orderList=t,this.updateStats()):this.orderList=[...this.orderList,...t],this.hasMore=this.currentPage<3},updateStats(){const t=(new Date).toDateString(),e=this.orderList.filter((e=>new Date(e.create_time).toDateString()===t));this.todayOrders=e.length,this.activeOrders=this.orderList.filter((t=>"active"===t.status)).length,this.todayRevenue=e.filter((t=>"completed"===t.status)).reduce(((t,e)=>t+parseFloat(e.total_amount)),0).toFixed(2)},loadMore(){this.hasMore&&!this.loading&&(this.currentPage++,this.loadOrderList())},getStatusClass:t=>({active:"status-active",completed:"status-completed",cancelled:"status-cancelled",expired:"status-expired"}[t]||"status-unknown"),getStatusText:t=>({active:"进行中",completed:"已完成",cancelled:"已取消",expired:"已过期"}[t]||"未知"),viewOrderDetail(t){console.log("查看订单详情:",t),a({url:`/pages/order-detail/order-detail?orderId=${t.id}&orderNo=${t.order_no}`})},formatTime(t){if(!t)return"";return new Date(t).toLocaleString("zh-CN")}}},[["render",function(t,e,a,v,S,k){const D=h,O=o,w=g,M=m;return r(),s(O,{class:"page"},{default:l((()=>[d(O,{class:"navbar"},{default:l((()=>[d(O,{class:"nav-left",onClick:k.goBack},{default:l((()=>[d(D,{class:"nav-icon"},{default:l((()=>[i("‹")])),_:1})])),_:1},8,["onClick"]),d(O,{class:"nav-center"},{default:l((()=>[d(D,{class:"nav-title"},{default:l((()=>[i(n(S.groupName)+" - 订单管理",1)])),_:1})])),_:1}),d(O,{class:"nav-right"},{default:l((()=>[d(D,{class:"nav-icon",onClick:k.refreshData},{default:l((()=>[i("⟲")])),_:1},8,["onClick"])])),_:1})])),_:1}),d(O,{class:"stats-section"},{default:l((()=>[d(O,{class:"stat-item"},{default:l((()=>[d(D,{class:"stat-value"},{default:l((()=>[i(n(S.todayOrders),1)])),_:1}),d(D,{class:"stat-label"},{default:l((()=>[i("今日订单")])),_:1})])),_:1}),d(O,{class:"stat-item"},{default:l((()=>[d(D,{class:"stat-value"},{default:l((()=>[i(n(S.activeOrders),1)])),_:1}),d(D,{class:"stat-label"},{default:l((()=>[i("进行中")])),_:1})])),_:1}),d(O,{class:"stat-item"},{default:l((()=>[d(D,{class:"stat-value"},{default:l((()=>[i("¥"+n(S.todayRevenue),1)])),_:1}),d(D,{class:"stat-label"},{default:l((()=>[i("今日收益")])),_:1})])),_:1})])),_:1}),d(M,{class:"orders-list","scroll-y":"true",onScrolltolower:k.loadMore},{default:l((()=>[(r(!0),c(f,null,u(S.orderList,(t=>(r(),s(O,{class:"order-item",key:t.id,onClick:e=>k.viewOrderDetail(t)},{default:l((()=>[d(O,{class:"order-header"},{default:l((()=>[d(D,{class:"order-id"},{default:l((()=>[i("订单 "+n(t.order_no),1)])),_:2},1024),d(D,{class:p(["order-status",k.getStatusClass(t.status)])},{default:l((()=>[i(n(k.getStatusText(t.status)),1)])),_:2},1032,["class"])])),_:2},1024),d(O,{class:"order-info"},{default:l((()=>[d(O,{class:"info-row"},{default:l((()=>[d(D,{class:"info-label"},{default:l((()=>[i("柜格编号:")])),_:1}),d(D,{class:"info-value"},{default:l((()=>[i(n(t.cell_no),1)])),_:2},1024)])),_:2},1024),d(O,{class:"info-row"},{default:l((()=>[d(D,{class:"info-label"},{default:l((()=>[i("存储时间:")])),_:1}),d(D,{class:"info-value"},{default:l((()=>[i(n(k.formatTime(t.start_time)),1)])),_:2},1024)])),_:2},1024),t.end_time?(r(),s(O,{key:0,class:"info-row"},{default:l((()=>[d(D,{class:"info-label"},{default:l((()=>[i("取出时间:")])),_:1}),d(D,{class:"info-value"},{default:l((()=>[i(n(k.formatTime(t.end_time)),1)])),_:2},1024)])),_:2},1024)):_("",!0),d(O,{class:"info-row"},{default:l((()=>[d(D,{class:"info-label"},{default:l((()=>[i("订单金额:")])),_:1}),d(D,{class:"info-value price"},{default:l((()=>[i("¥"+n(t.total_amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),S.hasMore?(r(),s(O,{key:0,class:"load-more"},{default:l((()=>[S.loading?(r(),s(D,{key:1,class:"load-text"},{default:l((()=>[i("加载中...")])),_:1})):(r(),s(D,{key:0,class:"load-text"},{default:l((()=>[i("上拉加载更多")])),_:1}))])),_:1})):_("",!0),!S.hasMore&&S.orderList.length>0?(r(),s(O,{key:1,class:"no-more"},{default:l((()=>[d(D,{class:"no-more-text"},{default:l((()=>[i("没有更多数据了")])),_:1})])),_:1})):_("",!0),S.loading||0!==S.orderList.length?_("",!0):(r(),s(O,{key:2,class:"empty-state"},{default:l((()=>[d(D,{class:"empty-icon"},{default:l((()=>[i("📋")])),_:1}),d(D,{class:"empty-text"},{default:l((()=>[i("暂无订单数据")])),_:1}),d(w,{class:"refresh-btn",onClick:k.refreshData},{default:l((()=>[i("刷新数据")])),_:1},8,["onClick"])])),_:1}))])),_:1},8,["onScrolltolower"])])),_:1})}],["__scopeId","data-v-bcc5d244"]]);export{S as default};
