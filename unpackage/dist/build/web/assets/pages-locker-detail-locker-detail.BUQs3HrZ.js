import{p as e,r as s,a,v as l,e as t,w as o,i as c,o as r,f as i,j as d,t as n,C as u,D as k,F as p,x as f,k as h,u as _,E as m,l as y}from"./index-BgeTyoVd.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=g({data:()=>({lockerInfo:{name:"",address:"",locker:[]},lockerTypes:[],selectedLockerType:0,hours:["1å°æ—¶","2å°æ—¶","3å°æ—¶","4å°æ—¶","8å°æ—¶"],selectedHour:0,pickupWays:["æŸœé—¨æ‰«ç å–ä»¶","æŸœé—¨å¯†ç å–ä»¶","æŸœå°äººå·¥å–ä»¶"],selectedPickupWay:0,depositResult:null,showDepositResult:!1,showChangeLocker:!1,newLockerId:null}),computed:{calcPrice(){var e;if(!this.lockerTypes.length)return"0.0";const s=this.lockerTypes[this.selectedLockerType];if(!s)return"0.0";const a=s.hourlyRate||0,l=this.hours[this.selectedHour],t=parseInt((null==(e=l.match(/\d+/))?void 0:e[0])||"1");return 0===a?"å…è´¹":(a*t).toFixed(2)}},onLoad(e){const s=e.locker_id||1;this.fetchLockerInfo(s)},methods:{goBack(){e()},onLockerTypeChange(e){this.selectedLockerType=e.detail.value},onHourChange(e){this.selectedHour=e.detail.value},onPickupWayChange(e){this.selectedPickupWay=e.detail.value},onConfirmDeposit(){const e=parseInt(this.hours[this.selectedHour].match(/\d+/)[0]),l=this.lockerTypes[this.selectedLockerType].lockerType,t=this.lockerInfo.id||1;s({url:"http://127.0.0.1:8000/deposit/createDeposit",method:"POST",data:{scheduled_duration:e,locker_type:l,cabinet_id:t},header:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTM3NTUyNDMsImlkIjoiMTIzIiwieW91cl9jdXN0b21fY2xhaW0iOiJ5b3VyX2N1c3RvbV92YWx1ZSJ9.qcdoe8dSYtfQBZgCP30Yln4r8z9ovPDEF1fNVlviWX4"},success:e=>{!e.data||200!==e.data.code&&"200"!==e.data.code?a({title:e.data.msg||"å¯„å­˜å¤±è´¥",icon:"none"}):(this.depositResult={order_no:e.data.data.orderNo,locker_id:e.data.data.lockerId},this.showDepositResult=!0)}})},onChangeLocker(){s({url:"http://127.0.0.1:8000/deposit/updateDepositLockerId",method:"POST",data:{order_id:this.depositResult.order_no},header:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTM3NTUyNDMsImlkIjoiMTIzIiwieW91cl9jdXN0b21fY2xhaW0iOiJ5b3VyX2N1c3RvbV92YWx1ZSJ9.qcdoe8dSYtfQBZgCP30Yln4r8z9ovPDEF1fNVlviWX4"},success:e=>{!e.data||200!==e.data.code&&"200"!==e.data.code?a({title:e.data.msg||"æ¢æŸœå¤±è´¥",icon:"none"}):(this.newLockerId=e.data.lockerId,this.showChangeLocker=!0)}})},onConfirmChangeLocker(){this.showChangeLocker=!1,this.depositResult.locker_id=this.newLockerId},goOrderDetail(){l({url:`/pages/order-detail/order-detail?order_no=${this.depositResult.order_no}`})},fetchLockerInfo(e){console.log("ðŸ”„ èŽ·å–å¯„å­˜æŸœä¿¡æ¯ï¼ŒID:",e),console.log("ðŸ“¦ ä½¿ç”¨æ¨¡æ‹Ÿå¯„å­˜æŸœæ•°æ®");const s=this.generateMockLockerData(e);setTimeout((()=>{this.lockerInfo=s,this.lockerTypes=(s.locker||[]).filter((e=>e.num>0)),this.selectedLockerType=0,console.log("âœ… å¯„å­˜æŸœä¿¡æ¯åŠ è½½å®Œæˆ:",this.lockerInfo)}),300)},generateMockLockerData(e){const s=[{name:"éƒ‘å·žç«è½¦ç«™å¯„å­˜æŸœ",address:"éƒ‘å·žç«è½¦ç«™è¥¿å¹¿åœºè·¯åŒ—100ç±³KFCé—¨å£"},{name:"éƒ‘å·žä¸œç«™å¯„å­˜æŸœ",address:"éƒ‘å·žä¸œç«™å—å¹¿åœºåœ°ä¸‹ä¸€å±‚"},{name:"äºŒä¸ƒå¹¿åœºå¯„å­˜æŸœ",address:"äºŒä¸ƒå¹¿åœºåœ°é“ç«™Bå‡ºå£"},{name:"ä¸­åŽŸç¦å¡”å¯„å­˜æŸœ",address:"ä¸­åŽŸç¦å¡”æ™¯åŒºå…¥å£å¤„"},{name:"æ²³å—åšç‰©é™¢å¯„å­˜æŸœ",address:"æ²³å—åšç‰©é™¢æ­£é—¨å·¦ä¾§"}],a=s[e%s.length]||s[0];return{id:e,name:a.name,address:a.address,status:"online",locker:[{name:"å°æŸœå­",description:"é€‚åˆèƒŒåŒ…ã€æ‰‹æåŒ…ç­‰å°ä»¶ç‰©å“",size:"33L(298*429*430mm)",num:Math.floor(5*Math.random())+1,hourlyRate:2,lockerType:1,freeDuration:0},{name:"ä¸­æŸœå­",description:"é€‚åˆè¡ŒæŽç®±ã€è´­ç‰©è¢‹ç­‰ä¸­ç­‰ç‰©å“",size:"53L(298*429*630mm)",num:Math.floor(3*Math.random())+1,hourlyRate:3,lockerType:2,freeDuration:0},{name:"å¤§æŸœå­",description:"é€‚åˆå¤§åž‹è¡ŒæŽç®±ã€å¤šä»¶ç‰©å“",size:"73L(298*429*830mm)",num:Math.floor(2*Math.random())+1,hourlyRate:5,lockerType:3,freeDuration:0}]}},useMockData(e){const s=this.generateMockLockerData(e);this.lockerInfo=s,this.lockerTypes=s.locker.filter((e=>e.num>0)),this.selectedLockerType=0},getLockerImg:e=>2===e?"https://img.icons8.com/ios-filled/100/000000/box.png":"https://img.icons8.com/ios-filled/100/000000/parcel.png"}},[["render",function(e,s,a,l,g,I){const C=h,L=c,T=_,v=m,D=y;return r(),t(L,{class:"locker-detail-container"},{default:o((()=>[i(L,{class:"header-bar"},{default:o((()=>[i(C,{class:"back-btn",onClick:I.goBack},{default:o((()=>[d("ã€ˆ")])),_:1},8,["onClick"]),i(C,{class:"header-title"},{default:o((()=>[d("æŸœå­ä¿¡æ¯")])),_:1})])),_:1}),i(L,{class:"site-info"},{default:o((()=>[i(L,{class:"site-title"},{default:o((()=>[d(n(g.lockerInfo.name),1)])),_:1}),i(L,{class:"site-address"},{default:o((()=>[i(C,{class:"iconfont"},{default:o((()=>[d("ðŸ“")])),_:1}),d(" "+n(g.lockerInfo.address),1)])),_:1}),i(L,{class:"site-map-btn"},{default:o((()=>[d("å¯¼èˆª")])),_:1})])),_:1}),i(L,{class:"available-section"},{default:o((()=>[i(L,{class:"section-title"},{default:o((()=>[d("å½“å‰å¯ç”¨ "),i(C,{class:"device-status"},{default:o((()=>[d("è®¾å¤‡åœ¨çº¿")])),_:1})])),_:1}),i(L,{class:"locker-list"},{default:o((()=>[(r(!0),u(p,null,k(g.lockerInfo.locker,(e=>(r(),t(L,{class:"locker-item",key:e.name},{default:o((()=>[i(T,{class:"locker-img",src:I.getLockerImg(e.lockerType)},null,8,["src"]),i(L,{class:"locker-desc"},{default:o((()=>[i(L,{class:"locker-name"},{default:o((()=>[d(n(e.name)+" ",1),e.num>0?(r(),t(C,{key:0,class:"locker-status"},{default:o((()=>[d("(å¯ç”¨)")])),_:1})):(r(),t(C,{key:1,class:"locker-status",style:{color:"#e74c3c"}},{default:o((()=>[d("(å·²æ»¡)")])),_:1}))])),_:2},1024),i(L,{class:"locker-size"},{default:o((()=>[d(n(e.size),1)])),_:2},1024),i(L,{class:"locker-rate"},{default:o((()=>[d(n(0===e.hourlyRate?"å…è´¹":e.hourlyRate+"å…ƒ/å°æ—¶"),1)])),_:2},1024),i(L,{class:"locker-desc-text"},{default:o((()=>[d(n(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),i(L,{class:"select-section"},{default:o((()=>[i(L,{class:"section-title"},{default:o((()=>[d("é€‰æ‹©å¯„å­˜")])),_:1}),i(L,{class:"select-row"},{default:o((()=>[i(C,null,{default:o((()=>[d("é€‰æ‹©æŸœå­åž‹å·")])),_:1}),i(v,{range:g.lockerTypes.map((e=>e.name)),value:g.selectedLockerType,onChange:I.onLockerTypeChange},{default:o((()=>[i(L,{class:"picker-value"},{default:o((()=>[d(n(g.lockerTypes[g.selectedLockerType]?g.lockerTypes[g.selectedLockerType].name:"æ— å¯ç”¨æŸœå­"),1)])),_:1})])),_:1},8,["range","value","onChange"])])),_:1}),i(L,{class:"select-row"},{default:o((()=>[i(C,null,{default:o((()=>[d("é€‰æ‹©å¯„å­˜æ—¶é•¿")])),_:1}),i(v,{range:g.hours,value:g.selectedHour,onChange:I.onHourChange},{default:o((()=>[i(L,{class:"picker-value"},{default:o((()=>[d(n(g.hours[g.selectedHour]),1)])),_:1})])),_:1},8,["range","value","onChange"])])),_:1}),i(L,{class:"select-row"},{default:o((()=>[i(C,null,{default:o((()=>[d("é€‰æ‹©å–ä»¶æ–¹å¼")])),_:1}),i(v,{range:g.pickupWays,value:g.selectedPickupWay,onChange:I.onPickupWayChange},{default:o((()=>[i(L,{class:"picker-value"},{default:o((()=>[d(n(g.pickupWays[g.selectedPickupWay]),1)])),_:1})])),_:1},8,["range","value","onChange"])])),_:1}),i(L,{class:"select-row price-row"},{default:o((()=>[i(C,null,{default:o((()=>[d("é¢„è®¡è´¹ç”¨ï¼ˆä¼˜æƒ åŽï¼‰ï¼š")])),_:1}),i(C,{class:"price"},{default:o((()=>[d("ï¿¥"+n(I.calcPrice),1)])),_:1})])),_:1})])),_:1}),i(L,{class:"pickup-section"},{default:o((()=>[i(L,{class:"section-title"},{default:o((()=>[d("å–ä»¶æ–¹å¼")])),_:1}),i(L,{class:"pickup-list"},{default:o((()=>[(r(!0),u(p,null,k(g.pickupWays,((e,s)=>(r(),t(L,{class:"pickup-item",key:e},{default:o((()=>[i(C,null,{default:o((()=>[d(n(e),1)])),_:2},1024),i(D,{size:"mini",type:s===g.selectedPickupWay?"primary":"default"},{default:o((()=>[d(n(s===g.selectedPickupWay?"å·²é€‰":"é€‰ç”¨"),1)])),_:2},1032,["type"])])),_:2},1024)))),128))])),_:1})])),_:1}),i(L,{class:"footer-bar"},{default:o((()=>[i(L,{class:"footer-price"},{default:o((()=>[d("åˆè®¡ï¿¥"+n(I.calcPrice),1)])),_:1}),i(D,{class:"footer-btn",type:"primary",onClick:I.onConfirmDeposit},{default:o((()=>[d("ç¡®è®¤å¯„å­˜")])),_:1},8,["onClick"])])),_:1}),g.showDepositResult?(r(),t(L,{key:0,class:"deposit-result-modal"},{default:o((()=>[i(T,{src:"https://img.icons8.com/ios-filled/100/000000/box.png",class:"result-img"}),i(L,{class:"result-title"},{default:o((()=>[d("æŸœé—¨å·²å¼€ï¼Œè¯·å­˜æ”¾æ‚¨çš„ç‰©å“")])),_:1}),i(L,{class:"result-locker-id"},{default:o((()=>[d(n(g.depositResult.locker_id)+"å·",1)])),_:1}),i(D,{class:"order-btn",onClick:I.goOrderDetail},{default:o((()=>[d("æŸ¥çœ‹è®¢å•")])),_:1},8,["onClick"]),i(L,{class:"change-locker-tip"},{default:o((()=>[d(" æŸœå­å¼‚å¸¸ï¼Ÿ"),i(C,{class:"change-link",onClick:I.onChangeLocker},{default:o((()=>[d("ç‚¹å‡»æ¢ä¸ªæŸœå­>>")])),_:1},8,["onClick"])])),_:1})])),_:1})):f("",!0),g.showChangeLocker?(r(),t(L,{key:1,class:"change-locker-modal"},{default:o((()=>[i(L,{class:"modal-title"},{default:o((()=>[d("æ›´æ¢æŸœé—¨")])),_:1}),i(L,{class:"modal-locker-id"},{default:o((()=>[d(n(g.newLockerId)+"å·",1)])),_:1}),i(L,{class:"modal-desc"},{default:o((()=>[d(" åŽŸ"+n(g.depositResult.locker_id)+"å·æŸœé—¨å¼‚å¸¸ï¼Œå³å°†ä¸ºæ‚¨æ‰“å¼€æ–°çš„æŸœé—¨ã€‚è¯·æ‚¨å–å‡ºåŽŸæŸœé—¨ä¸ªäººç‰©å“ï¼Œå­˜æ”¾åœ¨æ–°æŸœé—¨å†…ã€‚ ",1)])),_:1}),i(D,{class:"confirm-btn",onClick:I.onConfirmChangeLocker},{default:o((()=>[d("ç¡®è®¤")])),_:1},8,["onClick"])])),_:1})):f("",!0)])),_:1})}],["__scopeId","data-v-41be151c"]]);export{I as default};
