import{g as a,r as e,a as t,v as o,p as i,e as l,w as s,i as n,o as d,f as c,j as r,x as u,t as p,n as f,k as g,u as h}from"./index-BAOqw0gZ.js";import{_ as m}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=m({data:()=>({pointId:null,pointName:"",pointDetail:{name:"",address:"",pointType:"",availableLarge:0,availableMedium:0,availableSmall:0,openTime:"",staus:1,pointImage:""},isLoading:!0,error:"",isNavigating:!1}),onLoad(e){this.pointId=e.id||1,this.pointName=decodeURIComponent(e.name||""),console.log("网点详情页面加载 - ID:",this.pointId,"名称:",this.pointName),console.log("完整options:",e);const t=a("adminToken");console.log("当前token:",t),this.getPointDetail()},onShow(){this.isNavigating=!1,console.log("页面显示，重置导航状态")},methods:{getPointDetail(){this.isLoading=!0,this.error="",console.log("正在获取网点详情，ID:",this.pointId),this.pointDetail={name:"",address:"",pointType:"",availableLarge:0,availableMedium:0,availableSmall:0,openTime:"",staus:1,pointImage:""};const o={id:this.pointId};console.log("发送的请求数据:",o),e({url:"http://localhost:8000/point_info",method:"POST",data:o,header:{"Content-Type":"application/json",Authorization:"Bearer "+a("adminToken")},success:a=>{var e;if(this.isLoading=!1,console.log("网点详情接口返回数据:",a),!a.data||200!==a.data.code&&"200"!==a.data.code)this.error=(null==(e=a.data)?void 0:e.msg)||"获取网点详情失败",console.error("接口返回错误:",a.data),t({title:this.error,icon:"none"});else{console.log("原始接口返回数据:",a.data);const e=a.data.data||a.data;console.log("后端返回的原始数据:",e),this.pointDetail=e,console.log("处理后的网点详情:",this.pointDetail),t({title:"数据加载成功",icon:"success",duration:1e3})}},fail:a=>{this.isLoading=!1,console.error("网点详情请求失败:",a),this.error="网络请求失败",t({title:this.error,icon:"none"})}})},getCabinetInfo(){if(!this.pointDetail)return"0组0主机0柜门";const{availableLarge:a,availableMedium:e,availableSmall:t}=this.pointDetail;return`${parseInt(a)||0}组${parseInt(e)||0}主机${parseInt(t)||0}柜门`},editPoint(){console.log("点击编辑网点，ID:",this.pointId,"名称:",this.pointName),o({url:`/pages/point-edit/point-edit?id=${this.pointId}&name=${encodeURIComponent(this.pointName)}`})},openBaiduMap(){if(!this.pointDetail.address)return void t({title:"网点地址为空",icon:"none"});console.log("打开地图页面，地址:",this.pointDetail.address);const a=encodeURIComponent(this.pointDetail.name||"网点位置"),e=encodeURIComponent(this.pointDetail.address);o({url:`/pages/map-view/map-view?name=${a}&address=${e}`,success:()=>{console.log("跳转到地图页面成功")},fail:a=>{console.error("跳转到地图页面失败:",a),t({title:"跳转失败",icon:"none"})}})},goToPriceRule(){this.isNavigating?console.log("正在跳转中，忽略重复点击"):(this.isNavigating=!0,console.log("点击收费规则，网点ID:",this.pointId,"名称:",this.pointName),o({url:`/pages/price-rule/price-rule?id=${this.pointId}&name=${encodeURIComponent(this.pointName)}`,success:()=>{console.log("跳转成功"),setTimeout((()=>{this.isNavigating=!1}),500)},fail:a=>{console.error("跳转失败:",a),this.isNavigating=!1,t({title:"跳转失败",icon:"none"})}}))},goBack(){i()}}},[["render",function(a,e,t,o,i,m){const _=g,v=n,I=h;return d(),l(v,{class:"point-detail"},{default:s((()=>[c(v,{class:"header"},{default:s((()=>[c(v,{class:"back-btn",onClick:m.goBack},{default:s((()=>[c(_,{class:"back-icon"},{default:s((()=>[r("←")])),_:1})])),_:1},8,["onClick"]),c(v,{class:"title"},{default:s((()=>[r("我的网点")])),_:1}),c(v,{class:"header-right"},{default:s((()=>[c(_,{class:"edit-btn",onClick:m.editPoint},{default:s((()=>[r("编辑")])),_:1},8,["onClick"])])),_:1})])),_:1}),i.pointDetail?(d(),l(v,{key:0,class:"photo-section"},{default:s((()=>[c(v,{class:"photo-placeholder"},{default:s((()=>[i.pointDetail.pointImage?(d(),l(I,{key:0,src:i.pointDetail.pointImage,mode:"aspectFill",class:"main-photo"},null,8,["src"])):(d(),l(v,{key:1,class:"photo-upload"},{default:s((()=>[c(_,{class:"photo-icon"},{default:s((()=>[r("📷")])),_:1}),c(_,{class:"photo-text"},{default:s((()=>[r("网点照片")])),_:1})])),_:1}))])),_:1})])),_:1})):u("",!0),i.pointDetail?(d(),l(v,{key:1,class:"info-section"},{default:s((()=>[c(v,{class:"info-item"},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("网点名称")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r(p(i.pointDetail.name),1)])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1}),c(v,{class:"info-item clickable",onClick:m.openBaiduMap},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("网点地址")])),_:1}),c(v,{class:"address-container"},{default:s((()=>[c(_,{class:"location-icon"},{default:s((()=>[r("📍")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r(p(i.pointDetail.address),1)])),_:1})])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1},8,["onClick"]),c(v,{class:"info-item"},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("网点类型")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r(p(i.pointDetail.pointType),1)])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1}),c(v,{class:"info-item"},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("管理柜组")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r(p(m.getCabinetInfo()),1)])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1}),c(v,{class:"info-item"},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("营业时间")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r(p(i.pointDetail.openTime),1)])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1}),c(v,{class:"info-item"},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("网点状态")])),_:1}),c(_,{class:f(["info-value",1===i.pointDetail.staus?"status-normal":"status-closed"])},{default:s((()=>[r(p(1===i.pointDetail.staus?"正常":"暂停营业"),1)])),_:1},8,["class"]),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1}),c(v,{class:"info-item clickable",onClick:m.goToPriceRule},{default:s((()=>[c(_,{class:"info-label"},{default:s((()=>[r("收费规则")])),_:1}),c(_,{class:"info-value"},{default:s((()=>[r("查看")])),_:1}),c(_,{class:"arrow"},{default:s((()=>[r(">")])),_:1})])),_:1},8,["onClick"])])),_:1})):u("",!0),i.isLoading?(d(),l(v,{key:2,class:"loading"},{default:s((()=>[c(_,null,{default:s((()=>[r("加载中...")])),_:1})])),_:1})):u("",!0),i.error?(d(),l(v,{key:3,class:"error"},{default:s((()=>[c(_,null,{default:s((()=>[r(p(i.error),1)])),_:1})])),_:1})):u("",!0)])),_:1})}],["__scopeId","data-v-e94e1d4c"]]);export{_ as default};
