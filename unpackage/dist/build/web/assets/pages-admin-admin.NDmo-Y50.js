import{g as e,b as a,r as t,h as l,a as s,m as o,J as n,d as i,p as d,q as c,v as r,e as u,w as m,i as f,o as h,f as _,j as p,t as g,x as k,k as N,l as P}from"./index-BAOqw0gZ.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=y({data:()=>({pointNum:0,lastOrderNum:0,yesterdayOrderNum:0,lastOrderPrice:0,mouthPrice:0,monthNum:0,alarmCount:0,adminId:"",lockerPointId:"",lastUpdateTime:""}),onLoad(){console.log("é¡µé¢åŠ è½½å¼€å§‹"),this.loadAdminData()},onShow(){console.log("é¡µé¢æ˜¾ç¤º"),this.fetchAdminDataSilent()},methods:{loadAdminData(){e("adminToken");const a=e("adminId");e("adminMobile"),this.adminId=a||"1",this.lockerPointId="2",console.log("=== åˆå§‹åŒ–å‚æ•° ==="),console.log("ç®¡ç†å‘˜ID:",this.adminId),console.log("ç½‘ç‚¹ID:",this.lockerPointId),this.fetchAdminData()},fetchAdminDataSilent(){console.log("=== é™é»˜è·å–ç®¡ç†å‘˜æ•°æ® ==="),console.log("æ—¶é—´:",(new Date).toLocaleString()),this.fetchAdminDataInternal(!1)},fetchAdminData(){console.log("=== å¼€å§‹è·å–ç®¡ç†å‘˜æ•°æ® ==="),console.log("æ—¶é—´:",(new Date).toLocaleString()),a({title:"æ­£åœ¨è·å–æ•°æ®..."}),this.fetchAdminDataInternal(!0)},fetchAdminDataInternal(e=!0){const a={admin_id:this.adminId,locker_point_id:this.lockerPointId};console.log("=== è¯·æ±‚å‚æ•° ==="),console.log("ç®¡ç†å‘˜ID:",this.adminId),console.log("ç½‘ç‚¹ID:",this.lockerPointId),console.log("è¯·æ±‚æ•°æ®:",a);const o=`http://localhost:8000/admin?t=${(new Date).getTime()}`,n=new URLSearchParams;n.append("admin_id",a.admin_id),n.append("locker_point_id",a.locker_point_id),t({url:o,method:"POST",data:n.toString(),header:{"Content-Type":"application/x-www-form-urlencoded"},timeout:2e4,success:a=>{var t,o,n,i,d,c,r,u;if(e&&l(),console.log("=== APIå“åº” ==="),console.log("çŠ¶æ€ç :",a.statusCode),console.log("å“åº”æ•°æ®:",a.data),!a.data||200!==a.data.code&&"200"!==a.data.code)console.log("=== APIè¿”å›é”™è¯¯ ==="),console.log("é”™è¯¯ç :",null==(t=a.data)?void 0:t.code),console.log("é”™è¯¯ä¿¡æ¯:",null==(o=a.data)?void 0:o.msg),401===(null==(n=a.data)?void 0:n.code)||(null==(d=null==(i=a.data)?void 0:i.msg)?void 0:d.includes("æœªç™»å½•"))||(null==(r=null==(c=a.data)?void 0:c.msg)?void 0:r.includes("token"))?this.handleAuthError():s({title:`è·å–æ•°æ®å¤±è´¥: ${(null==(u=a.data)?void 0:u.msg)||"æœªçŸ¥é”™è¯¯"}`,icon:"none",duration:3e3});else{console.log("=== æ•°æ®æ˜ å°„å¼€å§‹ ===");const e=a.data;console.log("=== æ‰€æœ‰å­—æ®µ ==="),console.log("pointNum:",e.pointNum,typeof e.pointNum),console.log("lastOrderNum:",e.lastOrderNum,typeof e.lastOrderNum),console.log("yesterdayOrderNum:",e.yesterdayOrderNum,typeof e.yesterdayOrderNum),console.log("lastOrderPrice:",e.lastOrderPrice,typeof e.lastOrderPrice),console.log("mouthPrice:",e.mouthPrice,typeof e.mouthPrice),console.log("monthNum:",e.monthNum,typeof e.monthNum),this.pointNum=this.safeParseInt(e.pointNum),this.lastOrderNum=this.safeParseInt(e.lastOrderNum),this.yesterdayOrderNum=this.safeParseInt(e.yesterdayOrderNum),this.lastOrderPrice=this.safeParseFloat(e.lastOrderPrice),this.mouthPrice=this.safeParseFloat(e.mouthPrice),this.monthNum=this.safeParseInt(e.monthNum),console.log("=== æ•°æ®æ˜ å°„ç»“æœ ==="),console.log("ç½‘ç‚¹æ•°:",this.pointNum),console.log("ä»Šæ—¥è®¢å•:",this.lastOrderNum),console.log("æ˜¨æ—¥è®¢å•:",this.yesterdayOrderNum),console.log("æ˜¨æ—¥æ”¶ç›Š:",this.lastOrderPrice),console.log("æœ¬æœˆæ”¶ç›Š:",this.mouthPrice),console.log("æœ¬æœˆè®¢å•:",this.monthNum),this.lastUpdateTime=(new Date).toLocaleString(),s({title:"æ•°æ®å·²æ›´æ–°",icon:"success",duration:2e3})}},fail:a=>{e&&l(),console.log("=== ç½‘ç»œè¯·æ±‚å¤±è´¥ ==="),console.log("é”™è¯¯ä¿¡æ¯:",a.errMsg),console.log("é”™è¯¯è¯¦æƒ…:",a),e&&s({title:`ç½‘ç»œè¯·æ±‚å¤±è´¥: ${a.errMsg||"æœªçŸ¥é”™è¯¯"}`,icon:"none",duration:3e3})}})},safeParseInt(e){if(null==e||""===e)return 0;const a=parseInt(e);return isNaN(a)?0:a},safeParseFloat(e){if(null==e||""===e)return 0;const a=parseFloat(e);return isNaN(a)?0:a},handleAuthError(){o({title:"ç™»å½•å·²è¿‡æœŸ",content:"æ‚¨çš„ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•",showCancel:!1,success:()=>{n("adminToken"),n("adminId"),n("adminMobile"),i({url:"/pages/admin/login"})}})},forceRefreshData(){console.log("=== åˆ·æ–°æ•°æ® ==="),console.log("æ—¶é—´:",(new Date).toLocaleString()),this.fetchAdminData()},handleBack(){d()},handleMenu(){c({itemList:["é€€å‡ºç™»å½•","å¸®åŠ©","å…³äº"],success:e=>{console.log("é€‰æ‹©äº†:",e.tapIndex),0===e.tapIndex&&this.handleLogout()}})},handleLogout(){o({title:"ç¡®è®¤é€€å‡º",content:"ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ",success:e=>{e.confirm&&(n("adminToken"),n("adminId"),n("adminMobile"),s({title:"å·²é€€å‡ºç™»å½•",icon:"success"}),setTimeout((()=>{i({url:"/pages/admin/login"})}),1500))}})},handleProfile(){r({url:"/pages/admin/profile"})},handleMySites(){r({url:"/pages/point/point"})},handleCabinetManagement(){r({url:"/pages/location-select/location-select?from=admin&target=cabinet-group"})},handleOrderManagement(){s({title:"è®¢å•ç®¡ç†",icon:"none"})},handleRevenueDashboard(){s({title:"è¥æ”¶çœ‹æ¿",icon:"none"})},handleAlarm(){s({title:`å¼‚å¸¸æŠ¥è­¦ (${this.alarmCount}æ¡)`,icon:"none"})},handleSystemAdmin(){s({title:"ç³»ç»Ÿç®¡ç†å‘˜",icon:"none"})}}},[["render",function(e,a,t,l,s,o){const n=N,i=f,d=P;return h(),u(i,{class:"admin-container"},{default:m((()=>[_(i,{class:"header"},{default:m((()=>[_(i,{class:"header-left"},{default:m((()=>[_(n,{class:"back-icon",onClick:o.handleBack},{default:m((()=>[p("â†")])),_:1},8,["onClick"])])),_:1}),_(i,{class:"header-center"},{default:m((()=>[_(n,{class:"header-title"},{default:m((()=>[p("ç®¡ç†å‘˜")])),_:1})])),_:1}),_(i,{class:"header-right"},{default:m((()=>[_(n,{class:"menu-icon",onClick:o.handleMenu},{default:m((()=>[p("â‹¯")])),_:1},8,["onClick"]),_(n,{class:"profile-icon",onClick:o.handleProfile},{default:m((()=>[p("ğŸ‘¤")])),_:1},8,["onClick"])])),_:1})])),_:1}),_(i,{class:"overview-section"},{default:m((()=>[_(i,{class:"overview-header"},{default:m((()=>[_(n,{class:"overview-text"},{default:m((()=>[p("å…± "+g(s.pointNum)+" ä¸ªç½‘ç‚¹",1)])),_:1}),s.pointNum>0?(h(),u(n,{key:0,class:"overview-status"},{default:m((()=>[p("âœ… æ­£å¸¸")])),_:1})):(h(),u(n,{key:1,class:"overview-status error"},{default:m((()=>[p("â–² æ— æ•°æ®")])),_:1}))])),_:1}),_(i,{class:"revenue-note"},{default:m((()=>[_(n,{class:"note-text"},{default:m((()=>[p("*æ¯æ—¥9:00åç»“ç®—æ˜¨æ—¥æ”¶ç›Š")])),_:1}),_(n,{class:"question-icon"},{default:m((()=>[p("?")])),_:1})])),_:1}),s.lastUpdateTime?(h(),u(i,{key:0,class:"data-time"},{default:m((()=>[_(n,{class:"time-text"},{default:m((()=>[p("æ•°æ®åº“åŒæ­¥æ—¶é—´: "+g(s.lastUpdateTime),1)])),_:1})])),_:1})):k("",!0)])),_:1}),_(i,{class:"kpi-section"},{default:m((()=>[_(i,{class:"kpi-header"},{default:m((()=>[_(n,{class:"kpi-title"},{default:m((()=>[p("å®æ—¶æ•°æ®")])),_:1}),_(n,{class:"kpi-subtitle"},{default:m((()=>[p("åŸºäºæ•°æ®åº“å®æ—¶æŸ¥è¯¢")])),_:1})])),_:1}),_(i,{class:"kpi-grid"},{default:m((()=>[_(i,{class:"kpi-item"},{default:m((()=>[_(n,{class:"kpi-value"},{default:m((()=>[p(g(s.lastOrderNum),1)])),_:1}),_(n,{class:"kpi-label"},{default:m((()=>[p("ä»Šæ—¥è®¢å•")])),_:1}),_(n,{class:"kpi-desc"},{default:m((()=>[p("ä»Šæ—¥æ–°å¢è®¢å•æ•°")])),_:1})])),_:1}),_(i,{class:"kpi-item"},{default:m((()=>[_(n,{class:"kpi-value"},{default:m((()=>[p("Â¥"+g(s.lastOrderPrice),1)])),_:1}),_(n,{class:"kpi-label"},{default:m((()=>[p("æ˜¨æ—¥æ”¶ç›Š")])),_:1}),_(n,{class:"kpi-desc"},{default:m((()=>[p("æ˜¨æ—¥æ€»æ”¶ç›Šé‡‘é¢")])),_:1})])),_:1}),_(i,{class:"kpi-item"},{default:m((()=>[_(n,{class:"kpi-value"},{default:m((()=>[p(g(s.yesterdayOrderNum),1)])),_:1}),_(n,{class:"kpi-label"},{default:m((()=>[p("æ˜¨æ—¥è®¢å•")])),_:1}),_(n,{class:"kpi-desc"},{default:m((()=>[p("æ˜¨æ—¥å®Œæˆè®¢å•æ•°")])),_:1})])),_:1}),_(i,{class:"kpi-item"},{default:m((()=>[_(n,{class:"kpi-value"},{default:m((()=>[p("Â¥"+g(s.mouthPrice),1)])),_:1}),_(n,{class:"kpi-label"},{default:m((()=>[p("æœ¬æœˆæ”¶ç›Š")])),_:1}),_(n,{class:"kpi-desc"},{default:m((()=>[p("æœ¬æœˆç´¯è®¡æ”¶ç›Š")])),_:1})])),_:1}),_(i,{class:"kpi-item"},{default:m((()=>[_(n,{class:"kpi-value"},{default:m((()=>[p(g(s.monthNum),1)])),_:1}),_(n,{class:"kpi-label"},{default:m((()=>[p("æœ¬æœˆè®¢å•")])),_:1}),_(n,{class:"kpi-desc"},{default:m((()=>[p("æœ¬æœˆç´¯è®¡è®¢å•æ•°")])),_:1})])),_:1})])),_:1})])),_:1}),_(i,{class:"refresh-section"},{default:m((()=>[_(i,{class:"refresh-controls"},{default:m((()=>[_(d,{class:"refresh-btn",onClick:o.forceRefreshData},{default:m((()=>[_(n,{class:"refresh-icon"},{default:m((()=>[p("ğŸ”„")])),_:1}),_(n,{class:"refresh-text"},{default:m((()=>[p("åˆ·æ–°æ•°æ®")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),_(i,{class:"tools-section"},{default:m((()=>[_(n,{class:"section-title"},{default:m((()=>[p("ç®¡ç†å·¥å…·")])),_:1}),_(i,{class:"tools-grid"},{default:m((()=>[_(i,{class:"tool-item",onClick:o.handleMySites},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("æˆ‘çš„ç½‘ç‚¹")])),_:1})])),_:1},8,["onClick"]),_(i,{class:"tool-item",onClick:o.handleCabinetManagement},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("æŸœç»„ç®¡ç†")])),_:1})])),_:1},8,["onClick"]),_(i,{class:"tool-item",onClick:o.handleOrderManagement},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("è®¢å•ç®¡ç†")])),_:1})])),_:1},8,["onClick"]),_(i,{class:"tool-item",onClick:o.handleRevenueDashboard},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("è¥æ”¶çœ‹æ¿")])),_:1})])),_:1},8,["onClick"]),_(i,{class:"tool-item alarm",onClick:o.handleAlarm},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("å¼‚å¸¸æŠ¥è­¦")])),_:1}),s.alarmCount>0?(h(),u(i,{key:0,class:"alarm-badge"},{default:m((()=>[_(n,{class:"alarm-count"},{default:m((()=>[p(g(s.alarmCount),1)])),_:1})])),_:1})):k("",!0)])),_:1},8,["onClick"]),_(i,{class:"tool-item",onClick:o.handleSystemAdmin},{default:m((()=>[_(n,{class:"tool-text"},{default:m((()=>[p("ç³»ç»Ÿç®¡ç†å‘˜")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-891635a8"]]);export{I as default};
