import{$ as e,K as t,p as a,b as s,h as l,v as o,m as r,r as d,a as i,e as c,w as n,i as u,o as h,f,j as p,C as g,D as m,F as _,t as k,x as C,k as L,l as v,n as b,L as O,u as T}from"./index-C_HCjYUn.js";import{_ as x}from"./locker-image.D38akExJ.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=y({data:()=>({orderList:[],page:1,pageSize:20,hasMore:!0,loading:!1}),onLoad(){console.log("订单列表页面加载"),e("orderListData",(e=>{console.log("接收到订单数据:",e),this.orderList=e||[],console.log("设置订单列表:",this.orderList)})),0===this.orderList.length&&(console.log("没有接收到订单数据，重新获取"),this.loadOrderList())},onUnload(){t("orderListData")},methods:{handleBack(){a()},loadOrderList(){if(this.loading)return;this.loading=!0,s({title:"加载中..."}),console.log("订单列表页面使用模拟数据");const e=[{id:"1",title:"上海高铁站寄存柜",location:"上海高铁站寄存柜",detail:"寄存柜: 21号柜 (大)",price:"15.00",status:"active",createTime:"2024-01-15 14:30"},{id:"2",title:"台北车站寄存点",location:"台北车站寄存点",detail:"寄存柜: 15号柜 (中)",price:"12.00",status:"completed",createTime:"2024-01-14 10:20"},{id:"3",title:"北京机场寄存点",location:"北京机场寄存点",detail:"寄存柜: 8号柜 (小)",price:"10.00",status:"completed",createTime:"2024-01-13 09:15"}];setTimeout((()=>{l(),this.loading=!1,console.log("订单列表模拟数据:",e),1===this.page?this.orderList=e:this.orderList=[...this.orderList,...e],this.hasMore=!1}),1e3)},loadMore(){!this.loading&&this.hasMore&&(this.page++,this.loadOrderList())},handleOrderClick(e){console.log("点击订单:",e),o({url:`/pages/order-detail/order-detail?id=${e.id}`})},handleRetrieve(e){r({title:"确认取件",content:`确定要取出寄存的物品吗？\n订单号：${e.id}`,success:t=>{t.confirm&&(s({title:"处理中..."}),d({url:"http://localhost:8000/retrieve",method:"POST",data:{orderId:e.id},header:{"Content-Type":"application/x-www-form-urlencoded"},success:e=>{var t;l(),!e.data||200!==e.data.code&&"200"!==e.data.code?i({title:(null==(t=e.data)?void 0:t.msg)||"取件失败",icon:"none"}):(i({title:"取件成功",icon:"success"}),this.page=1,this.loadOrderList())},fail:e=>{l(),i({title:"网络错误，请重试",icon:"none"})}}))}})},handleOrderDetail(e){o({url:`/pages/order-detail/order-detail?id=${e.id}`})},getStatusClass(e){switch(e){case"active":return"status-active";case"completed":return"status-completed";case"cancelled":return"status-cancelled";default:return"status-default"}},getStatusText(e){switch(e){case"active":return"进行中";case"completed":return"已完成";case"cancelled":return"已取消";default:return"未知"}}}},[["render",function(e,t,a,s,l,o){const r=L,d=u,i=T,y=v;return h(),c(d,{class:"order-list-container"},{default:n((()=>[f(d,{class:"header"},{default:n((()=>[f(d,{class:"back-btn",onClick:o.handleBack},{default:n((()=>[f(r,{class:"back-icon"},{default:n((()=>[p("←")])),_:1})])),_:1},8,["onClick"]),f(r,{class:"header-title"},{default:n((()=>[p("全部订单")])),_:1})])),_:1}),f(d,{class:"order-list"},{default:n((()=>[0===l.orderList.length?(h(),c(d,{key:0,class:"empty-state"},{default:n((()=>[f(r,{class:"empty-text"},{default:n((()=>[p("暂无订单")])),_:1})])),_:1})):(h(),c(d,{key:1},{default:n((()=>[(h(!0),g(_,null,m(l.orderList,((e,t)=>(h(),c(d,{key:t,class:"order-item",onClick:t=>o.handleOrderClick(e)},{default:n((()=>[f(d,{class:"order-header"},{default:n((()=>[f(r,{class:"order-title"},{default:n((()=>[p(k(e.title||"寄存服务"),1)])),_:2},1024),f(r,{class:b(["order-status",o.getStatusClass(e.status)])},{default:n((()=>[p(k(o.getStatusText(e.status)),1)])),_:2},1032,["class"])])),_:2},1024),f(d,{class:"order-content"},{default:n((()=>[f(d,{class:"order-image"},{default:n((()=>[f(i,{src:x,class:"locker-image",mode:"aspectFill"})])),_:1}),f(d,{class:"order-info"},{default:n((()=>[f(r,{class:"order-location"},{default:n((()=>[p(k(e.location||"上海高铁站寄存柜"),1)])),_:2},1024),f(r,{class:"order-detail"},{default:n((()=>[p(k(e.detail||"寄存柜: 21号柜 (大)"),1)])),_:2},1024),f(r,{class:"order-time"},{default:n((()=>[p(k(e.createTime||"2024-01-15 14:30"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(d,{class:"order-footer"},{default:n((()=>[f(r,{class:"order-price"},{default:n((()=>[p("¥"+k(e.price||"15.00"),1)])),_:2},1024),f(d,{class:"order-actions"},{default:n((()=>["active"===e.status?(h(),c(y,{key:0,class:"action-btn retrieve-btn",onClick:O((t=>o.handleRetrieve(e)),["stop"])},{default:n((()=>[p(" 取件 ")])),_:2},1032,["onClick"])):C("",!0),f(y,{class:"action-btn detail-btn",onClick:O((t=>o.handleOrderDetail(e)),["stop"])},{default:n((()=>[p(" 详情 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}))])),_:1}),l.hasMore?(h(),c(d,{key:0,class:"load-more"},{default:n((()=>[f(y,{class:"load-more-btn",onClick:o.loadMore,disabled:l.loading},{default:n((()=>[p(k(l.loading?"加载中...":"加载更多"),1)])),_:1},8,["onClick","disabled"])])),_:1})):C("",!0)])),_:1})}],["__scopeId","data-v-120f7ceb"]]);export{w as default};
