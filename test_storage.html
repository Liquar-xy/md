<!DOCTYPE html>
<html>
<head>
    <title>å­˜å‚¨æµ‹è¯•</title>
    <style>
        body { padding: 20px; font-family: Arial; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; }
    </style>
</head>
<body>
    <h2>å­˜å‚¨æµ‹è¯•</h2>
    
    <button onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
    <button onclick="checkStorage()">æ£€æŸ¥å­˜å‚¨</button>
    <button onclick="clearStorage()">æ¸…é™¤å­˜å‚¨</button>
    
    <div id="result" class="result"></div>

    <script>
        function testLogin() {
            const data = {
                Mobile: '13800138000',
                Password: '123456',
                SmsCode: '1234'
            };
            
            document.getElementById('result').innerHTML = 'ç™»å½•ä¸­...';
            
            fetch('http://localhost:8000/admin/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams(data)
            })
            .then(res => res.json())
            .then(data => {
                console.log('ç™»å½•å“åº”:', data);
                
                if (data.code === 200 || data.code === "200") {
                    // ä¿å­˜ç™»å½•ä¿¡æ¯
                    const adminId = data.id || '13800138000';
                    const adminToken = data.token || 'test-token-' + Date.now();
                    
                    localStorage.setItem('adminToken', adminToken);
                    localStorage.setItem('adminId', String(adminId));
                    localStorage.setItem('adminMobile', '13800138000');
                    
                    document.getElementById('result').innerHTML = 
                        'âœ… ç™»å½•æˆåŠŸ!<br>' +
                        'ID: ' + adminId + '<br>' +
                        'Token: ' + adminToken + '<br>' +
                        'å·²ä¿å­˜åˆ°localStorage';
                } else {
                    document.getElementById('result').innerHTML = 
                        'âŒ ç™»å½•å¤±è´¥: ' + (data.msg || 'æœªçŸ¥é”™è¯¯');
                }
            })
            .catch(err => {
                document.getElementById('result').innerHTML = 'âŒ è¯·æ±‚å¤±è´¥: ' + err.message;
            });
        }
        
        function checkStorage() {
            const adminToken = localStorage.getItem('adminToken');
            const adminId = localStorage.getItem('adminId');
            const adminMobile = localStorage.getItem('adminMobile');
            
            document.getElementById('result').innerHTML = 
                'ğŸ“‹ å­˜å‚¨çŠ¶æ€:<br>' +
                'adminToken: ' + (adminToken || 'æœªæ‰¾åˆ°') + '<br>' +
                'adminId: ' + (adminId || 'æœªæ‰¾åˆ°') + '<br>' +
                'adminMobile: ' + (adminMobile || 'æœªæ‰¾åˆ°') + '<br>' +
                'ç™»å½•çŠ¶æ€: ' + (adminToken || adminId || adminMobile ? 'å·²ç™»å½•' : 'æœªç™»å½•');
        }
        
        function clearStorage() {
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminId');
            localStorage.removeItem('adminMobile');
            document.getElementById('result').innerHTML = 'ğŸ—‘ï¸ å·²æ¸…é™¤æ‰€æœ‰æ•°æ®';
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥å­˜å‚¨
        window.onload = function() {
            checkStorage();
        };
    </script>
</body>
</html> 