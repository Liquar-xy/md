# 基于城市选择的定位系统

## 概述

本应用的"我的附近"功能是基于用户选择的城市来定位的，而不是基于用户的实际GPS位置。这种设计有以下优势：

## 设计理念

### 1. 城市选择优先
- 用户在首页可以选择目标城市
- 所有的"附近"功能都基于选择的城市中心点
- 避免了GPS定位的隐私问题和技术复杂性

### 2. 稳定可靠
- 不依赖GPS信号强度
- 不受用户移动影响
- 在室内环境也能正常工作

### 3. 用户体验友好
- 用户可以提前查看目的地城市的寄存点
- 适合出行规划场景
- 避免定位权限申请的困扰

## 实现逻辑

### 首页 (index.vue)
1. 用户通过城市选择器选择目标城市
2. 选择的城市信息保存在 `uni.getStorageSync('selectedCity')`
3. 基于选择城市的坐标获取附近寄存点
4. 显示该城市最近的寄存点信息

### 附近页面 (nearby.vue)
1. 读取用户选择的城市信息
2. 地图中心点设置为城市坐标
3. 在地图上显示城市位置标记
4. 搜索该城市范围内的所有寄存点
5. 在地图上标注寄存点位置

## 数据结构

### 城市信息格式
```javascript
{
  name: "郑州",           // 城市名称
  coordinates: {
    longitude: 113.6253,  // 经度
    latitude: 34.7466     // 纬度
  }
}
```

### 位置信息格式
```javascript
{
  longitude: "113.625300",
  latitude: "34.746600",
  accuracy: 1000,
  timestamp: "14:30:25",
  address: "郑州市中心",
  source: "城市选择"
}
```

## 用户界面说明

### 状态显示
- "城市定位状态" 而不是 "实时定位状态"
- "当前城市位置" 而不是 "实时位置"
- "回到城市" 按钮而不是 "定位" 按钮

### 地图标记
- 使用橙色图标标记城市中心位置
- 使用红色图标标记寄存点位置
- 信息窗口显示 "城市选择" 作为定位方式

## 扩展功能

### 1. 城市切换
用户可以随时切换城市，系统会：
- 更新地图中心点
- 重新搜索新城市的寄存点
- 更新所有相关显示信息

### 2. 默认城市
如果用户没有选择城市，系统使用郑州作为默认城市

### 3. 搜索范围
- 默认搜索半径：5公里
- 可扩大到10公里范围
- 基于城市中心点计算距离

## 技术优势

1. **简化实现**：不需要处理GPS权限和定位失败
2. **性能稳定**：不依赖设备定位能力
3. **用户友好**：符合出行规划的使用场景
4. **隐私保护**：不获取用户真实位置信息

## 使用场景

- 出行前查看目的地城市的寄存点
- 在不同城市间切换查看寄存服务
- 规划行程路线时参考寄存点分布
- 避免到达目的地后才发现没有寄存服务